(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{622:function(t,a,s){"use strict";s.r(a);var n=s(3),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("Boxx"),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#webrtc-简介-https-appr-tc"}},[t._v("webRTC 简介（https://appr.tc）")])]),s("li",[s("a",{attrs:{href:"#webrtc应用"}},[t._v("webRTC应用")])]),s("li",[s("a",{attrs:{href:"#webrtc设备管理"}},[t._v("webRTC设备管理")])]),s("li",[s("a",{attrs:{href:"#音视频采集api"}},[t._v("音视频采集API")])]),s("li",[s("a",{attrs:{href:"#mediastreamconstraints"}},[t._v("MediaStreamConstraints")])]),s("li",[s("a",{attrs:{href:"#启动nodejs服务"}},[t._v("启动nodejs服务")])]),s("li",[s("a",{attrs:{href:"#视频特效"}},[t._v("视频特效")])]),s("li",[s("a",{attrs:{href:"#mediastream-方法"}},[t._v("MediaStream 方法")])]),s("li",[s("a",{attrs:{href:"#mediastream-事件"}},[t._v("MediaStream 事件")])]),s("li",[s("a",{attrs:{href:"#webrtc录制"}},[t._v("webRTC录制")])]),s("li",[s("a",{attrs:{href:"#mediarecorder-api"}},[t._v("mediaRecorder API")])]),s("li",[s("a",{attrs:{href:"#mediarecorder-事件"}},[t._v("MediaRecorder 事件")])]),s("li",[s("a",{attrs:{href:"#javascript几种存储数据的方式"}},[t._v("JavaScript几种存储数据的方式")])]),s("li",[s("a",{attrs:{href:"#webrtc信令服务器"}},[t._v("webRTC信令服务器")])]),s("li",[s("a",{attrs:{href:"#socket-io-实现信令服务器"}},[t._v("socket.io 实现信令服务器")])]),s("li",[s("a",{attrs:{href:"#socket-io发送消息"}},[t._v("Socket.IO发送消息")])]),s("li",[s("a",{attrs:{href:"#socket-io客户端处理消息"}},[t._v("socket.io客户端处理消息")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"webrtc-简介-https-appr-tc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webrtc-简介-https-appr-tc"}},[t._v("#")]),t._v(" webRTC 简介（https://appr.tc）")]),t._v(" "),s("ol",[s("li",[t._v("2010年google开源跨平台用于浏览器实时传输音视频引擎")]),t._v(" "),s("li",[t._v("音视频处理+即时通讯的开源库")])]),t._v(" "),s("h2",{attrs:{id:"webrtc应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webrtc应用"}},[t._v("#")]),t._v(" webRTC应用")]),t._v(" "),s("ol",[s("li",[t._v("照相机，音乐播放器，共享远程桌面，录制，即使通讯工具，p2p网络加速文件传输工具，游戏，实时人脸识别，音视频会议，在线教育")])]),t._v(" "),s("h2",{attrs:{id:"webrtc设备管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webrtc设备管理"}},[t._v("#")]),t._v(" webRTC设备管理")]),t._v(" "),s("ol",[s("li",[t._v("enumerateDevices")])]),t._v(" "),s("ul",[s("li",[t._v("基本格式")])]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ePromise "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mediaDevices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("enumerateDevices")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mediaDevices "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mediaDevices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enumerateDevices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'设备不支持mediaDevices'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" mediaDevice "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mediaDevices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("enumerateDevices")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("getDevices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("handleError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDevices")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("deviceInfos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    deviceInfos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("deviceInfo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("设备的种类-")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("deviceInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("kind"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("设备的名称-")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("deviceInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("label"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("-设备ID-")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("deviceInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("deviceId"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("-groupId-")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("deviceInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleError")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("MediaDevicesInfo\n"),s("ul",[s("li",[t._v("deviceID 设备ID")]),t._v(" "),s("li",[t._v("label    设备的名字")]),t._v(" "),s("li",[t._v("kind     设备的种类")]),t._v(" "),s("li",[t._v("groupID  两个设备groupID相同，说明是同一个物理设备")])])])]),t._v(" "),s("h2",{attrs:{id:"音视频采集api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#音视频采集api"}},[t._v("#")]),t._v(" 音视频采集API")]),t._v(" "),s("ol",[s("li",[t._v("基本格式")])]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" promise "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mediaDevices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserMedia")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constraints"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h2",{attrs:{id:"mediastreamconstraints"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mediastreamconstraints"}},[t._v("#")]),t._v(" MediaStreamConstraints")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v(" dictionary MediaStreamConstraints"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("boolean or MediaTrackConstraints"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" video "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("boolean or MediaTrackConstraints"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" audio "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mediaDevices "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mediaDevices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getUserMedia"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'设备不支持getUserMedia'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" constraints "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        audio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        video"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" mediaStream "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mediaDevices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserMedia")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constraints"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gotMediaStream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mediaStreamError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mediaStreamError")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("gotMediaStream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" video "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'video'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    video"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("srcObject "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" stream\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("适配不同浏览器的方法\n"),s("ul",[s("li",[t._v("自己实现")])])])]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" getUserMedia "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getUserMedia "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webkitGetUserMedia "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mozGetUserMedia\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("使用Google开源库 adapter.js (https://webrtc.github.io/adapter/adapter-latest.js)")])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("webRTC音视频采集约束\n"),s("ol",[s("li",[t._v("width,height,")]),t._v(" "),s("li",[t._v("aspectRatio (描述用于一个视频轨迹的宽高比的可接受的或所需的值（一个或多个）。该值是宽度除以高度，并四舍五入到十位小数。\n例如，16：9的标准高清视频宽高比可以计算为1920/1080或1.7777777778)")]),t._v(" "),s("li",[t._v("frameRate(帧率，可以控制码流，如果帧率低会看到画面不平滑，帧率大码流大，相当于每秒采集的数据变多) 可以设置min max")]),t._v(" "),s("li",[t._v("facingMode（控制摄像头翻转）\n"),s("ul",[s("li",[t._v("user 前置摄像头")]),t._v(" "),s("li",[t._v("environment 后置摄像头")]),t._v(" "),s("li",[t._v("left 前置左侧摄像头")]),t._v(" "),s("li",[t._v("right 前置右侧摄像头")])])]),t._v(" "),s("li",[t._v("resizeMode （采集的画面要不要裁剪）")]),t._v(" "),s("li",[t._v("volume (0.0~1.0)")]),t._v(" "),s("li",[t._v("sampleRate (音频采样率如：48000，36000，8000)")]),t._v(" "),s("li",[t._v("sampleSize（音频采样率，一般16位，也就是两个字节）")]),t._v(" "),s("li",[t._v("echoCancellation（回音消除，值为布尔值）")]),t._v(" "),s("li",[t._v("autoGainControl（自定义增益，在原有声音的基础上是否增加音量）")]),t._v(" "),s("li",[t._v("noiseSuppression（降噪，在采集数据时是否要开启降噪功能，值为布尔值）")]),t._v(" "),s("li",[t._v("latency")])]),t._v(" "),s("ul",[s("li",[t._v("设置latency小，延迟小，当网络不好时会出现花屏，卡顿现象等问题，好处是可以实时通讯")]),t._v(" "),s("li",[t._v("设置latency大，画面，声音更平滑，及时性不好")])]),t._v(" "),s("ol",{attrs:{start:"13"}},[s("li",[t._v("channelCount（单声道双声道，一般为单声道，如果是乐器为双声道）")]),t._v(" "),s("li",[t._v("deviceID (设备ID)")]),t._v(" "),s("li",[t._v("groupID  （设备组ID，若组ID相同则是同一套设备）")])])])]),t._v(" "),s("h2",{attrs:{id:"启动nodejs服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动nodejs服务"}},[t._v("#")]),t._v(" 启动nodejs服务")]),t._v(" "),s("ol",[s("li",[t._v("forever start app.js(启用后台运行程序)")])]),t._v(" "),s("h2",{attrs:{id:"视频特效"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#视频特效"}},[t._v("#")]),t._v(" 视频特效")]),t._v(" "),s("ol",[s("li",[t._v("grayscale   灰度    opacity      透明度")]),t._v(" "),s("li",[t._v("sepia       褐色    brightness   亮度")]),t._v(" "),s("li",[t._v("saturate    饱和度  contrast     对比度")]),t._v(" "),s("li",[t._v("hue-rotate  色相旋转  blur       模糊")]),t._v(" "),s("li",[t._v("invert      反色     drop-shadow  阴影")])]),t._v(" "),s("h2",{attrs:{id:"mediastream-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mediastream-方法"}},[t._v("#")]),t._v(" MediaStream 方法")]),t._v(" "),s("ol",[s("li",[t._v("mediaStream.addTrack()\n"),s("ul",[s("li",[t._v("给流添加一个新轨道。指定一个MediaStreamTrack对象作为参数")])])]),t._v(" "),s("li",[t._v("mediaStream.removeTrack()\n"),s("ul",[s("li",[t._v("移除一个轨道")])])]),t._v(" "),s("li",[t._v("mediaStream.getVideoTracks()\n"),s("ul",[s("li",[t._v("获取视频轨")])])]),t._v(" "),s("li",[t._v("mediaStream.getAudioTracks()\n"),s("ul",[s("li",[t._v("获取音频轨")])])])]),t._v(" "),s("h2",{attrs:{id:"mediastream-事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mediastream-事件"}},[t._v("#")]),t._v(" MediaStream 事件")]),t._v(" "),s("ol",[s("li",[t._v("MediaStream.onaddtrack")]),t._v(" "),s("li",[t._v("MediaStream.onended")]),t._v(" "),s("li",[t._v("MediaStream.onremovetrack")])]),t._v(" "),s("h2",{attrs:{id:"webrtc录制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webrtc录制"}},[t._v("#")]),t._v(" webRTC录制")]),t._v(" "),s("ol",[s("li",[t._v("MediaRecoder")])]),t._v(" "),s("ul",[s("li",[t._v("基本格式")])]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" mediaRecorder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MediaRecorder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n参数stream（媒体流） 可从getUserMedia"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("video"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("audio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("或"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("canvas"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("获取\noptions   限制选项 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" mimeType   指定录制的是音频还是视频，录制的格式是什么\n   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" video"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("webm\n   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" audio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("webm\n   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" video"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("webm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("codecs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vp8\n   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" video"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("webm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("codecs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" h264\n   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" audio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("webm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("codecs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" opus\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v(" audioBitsPerSecond 音频编码\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v(" videoBitsPerSecond 视频码率\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.")]),t._v(" bitsPerSecond 整体码率\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("h2",{attrs:{id:"mediarecorder-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mediarecorder-api"}},[t._v("#")]),t._v(" mediaRecorder API")]),t._v(" "),s("ol",[s("li",[t._v("MediaRecorder.start(timeslice)")])]),t._v(" "),s("ul",[s("li",[t._v("没有选择timeslice，则它所有的录制数据都会保存到buffer里去")]),t._v(" "),s("li",[t._v("如果设置timeslice，会按照时间切片存储数据")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("MediaRecorder.stop()")])]),t._v(" "),s("ul",[s("li",[t._v("停止录制，此时会触发包括最终blob数据的dataavailable事件")])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("MediaRecorder.pause")])]),t._v(" "),s("ul",[s("li",[t._v("暂停录制")])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[t._v("MediaRecorder.resume()")])]),t._v(" "),s("ul",[s("li",[t._v("恢复录制")])]),t._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[t._v("MediaRecorder.isTypeSupported()")])]),t._v(" "),s("ul",[s("li",[t._v("检查可以录制的格式 --mp4,mp3...")])]),t._v(" "),s("h2",{attrs:{id:"mediarecorder-事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mediarecorder-事件"}},[t._v("#")]),t._v(" MediaRecorder 事件")]),t._v(" "),s("ol",[s("li",[t._v("MediaRecorder.ondataavailable")])]),t._v(" "),s("ul",[s("li",[t._v("当数据有效时触发")]),t._v(" "),s("li",[t._v("每次记录一定时间的数据时（如果没有指定时间片，则记录整个数据时）会定期触发")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("MediaRecorder.onerror")])]),t._v(" "),s("ul",[s("li",[t._v("当有错误发生时，录制会被停止")])]),t._v(" "),s("h2",{attrs:{id:"javascript几种存储数据的方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript几种存储数据的方式"}},[t._v("#")]),t._v(" JavaScript几种存储数据的方式")]),t._v(" "),s("ol",[s("li",[t._v("字符串")]),t._v(" "),s("li",[t._v("Blob")]),t._v(" "),s("li",[t._v("ArrayBuffer")]),t._v(" "),s("li",[t._v("ArrayBufferView")])]),t._v(" "),s("h2",{attrs:{id:"webrtc信令服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webrtc信令服务器"}},[t._v("#")]),t._v(" webRTC信令服务器")]),t._v(" "),s("h2",{attrs:{id:"socket-io-实现信令服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#socket-io-实现信令服务器"}},[t._v("#")]),t._v(" socket.io 实现信令服务器")]),t._v(" "),s("ol",[s("li",[t._v("socket.io是WebSocket超集")]),t._v(" "),s("li",[t._v("socket.io有房间的概念")]),t._v(" "),s("li",[t._v("socket.io 跨平台，跨终端，跨语言")])]),t._v(" "),s("h2",{attrs:{id:"socket-io发送消息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#socket-io发送消息"}},[t._v("#")]),t._v(" Socket.IO发送消息")]),t._v(" "),s("ol",[s("li",[t._v("给本次连接发消息  socket.emit()")]),t._v(" "),s("li",[t._v("给某个房间内所有人发送消息  io.in(room).emit()  io 为所有的节点")]),t._v(" "),s("li",[t._v("除本连接外，给某个房间内所有人发送消息 socket.to(room).emit()\n"),s("ul",[s("li",[t._v("socket 为创建连接时的socket")])])]),t._v(" "),s("li",[t._v("除本连接外，给所有人发送消息 socket.broadcast.emit()")])]),t._v(" "),s("h2",{attrs:{id:"socket-io客户端处理消息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#socket-io客户端处理消息"}},[t._v("#")]),t._v(" socket.io客户端处理消息")]),t._v(" "),s("ol",[s("li",[t._v("发送action命令\n"),s("ul",[s("li",[t._v("S: socket.emit('action');")]),t._v(" "),s("li",[t._v("C: socket.on('action',function(){...});")])])]),t._v(" "),s("li",[t._v("发送一个action命令，带数据\n"),s("ul",[s("li",[t._v("S: socket.emit('action',data);")]),t._v(" "),s("li",[t._v("C: socket.on('action',function(data){...});")])])]),t._v(" "),s("li",[t._v("发送action命令，还有两个数据\n"),s("ul",[s("li",[t._v("S: soket.emit(action,arg1,arg2);")]),t._v(" "),s("li",[t._v("C: socket.on('action',function(arg1,arg2){...})")])])]),t._v(" "),s("li",[t._v("发送一个action命令，在emit方法中包含回调函数\n"),s("ul",[s("li",[t._v("S: socket.emit('action',data,function(arg1,arg2){...});")]),t._v(" "),s("li",[t._v("C: socket.on('action', function(data,fn){'a','b'})")])])])])],1)}),[],!1,null,null,null);a.default=e.exports}}]);